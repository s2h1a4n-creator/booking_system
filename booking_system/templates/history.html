<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>會員預約紀錄查詢</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --black: #111111;
            --gun: #2B2B2B;
            --gold: #D5C79A;
            --gold-light: #F5EED4;
        }

        body {
            background-color: var(--black);
            color: var(--gold-light);
            font-family: "Noto Sans TC", sans-serif;
        }
        .card {
            background-color: #1A1A1A;
            border: 1px solid var(--gold);
            border-radius: 12px;
            padding: 20px;
        }
        .title-box {
            background-color: #1C1C1C;
            border: 1px solid var(--gold);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
        }
        .title-box h2 {
            color: var(--gold);
            font-weight: 800;
        }
        label {
            color: var(--gold);
            font-weight: 600;
        }
        .btn-gold {
            background-color: var(--gold);
            color: black;
            font-weight: 700;
        }
        .btn-gold:hover {
            background-color: #E8DFC0;
        }
        .table thead {
            color: var(--gold);
            border-bottom: 2px solid var(--gold);
        }
    </style>
</head>

<body>

<div class="container py-4">

    <div class="title-box">
        <h2>會員預約紀錄查詢</h2>
    </div>

    <!-- 搜尋區：姓名 + 生日 -->
    <div class="card mb-4">
        <form method="POST">
            <div class="row g-3">
                <div class="col-md-6">
                    <label>姓名（必填）</label>
                    <input type="text" name="name" class="form-control" value="{{ name }}" required>
                </div>
                <div class="col-md-6">
                    <label>生日（必填）</label>
                    <input type="date" name="birthday" class="form-control" value="{{ birthday }}" required>
                </div>
            </div>

            <button class="btn btn-gold px-4 mt-3" type="submit">查詢</button>
        </form>
    </div>

    <!-- 顯示會員資料（可直接編輯） -->
    {% if member_info %}
    <div class="card mb-4">
        <form method="POST" action="/history/update">

            <input type="hidden" name="old_name" value="{{ member_info.name }}">
            <input type="hidden" name="old_birthday" value="{{ member_info.birthday }}">

            <h5 style="color: var(--gold); font-weight:700;">會員資料 </h5>

            <div class="row g-3 mt-2">

                <div class="col-md-6">
                    <label>姓名</label>
                    <input type="text" name="name" class="form-control" value="{{ member_info.name }}" required>
                </div>

                <div class="col-md-6">
                    <label>生日</label>
                    <input type="date" name="birthday" class="form-control" value="{{ member_info.birthday }}" required>
                </div>

                <div class="col-md-6">
                    <label>電話</label>
                    <input type="text" name="phone" class="form-control" value="{{ member_info.phone }}">
                </div>

                <div class="col-md-6">
                    <label>Email</label>
                    <input type="email" name="email" class="form-control" value="{{ member_info.email }}">
                </div>

                <div class="col-md-6">
                    <label>性別</label>
                    <input type="text" name="gender" class="form-control" value="{{ member_info.gender }}">
                </div>

                <div class="col-md-6">
                    <label>Line ID</label>
                    <input type="text" name="line_id" class="form-control" value="{{ member_info.line_id }}">
                </div>

            </div>

            <div class="text-end mt-3">
                <button type="submit" class="btn btn-gold px-4">儲存變更</button>
            </div>

        </form>
    </div>
    {% endif %}

    <!-- 預約紀錄 -->
    {% if records %}
    <div class="card">

        <h5 style="color: var(--gold); font-weight:700;">預約紀錄</h5>

        <table class="table mt-3">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>時間</th>
                    <th>教練</th>
                    <th>課程</th>
                    <th>備註</th>
                </tr>
            </thead>
            <tbody>
                {% for r in records %}
                <tr>
                    <td>{{ r.date }}</td>
                    <td>{{ r.time }}</td>
                    <td>{{ r.coach }}</td>
                    <td>{{ r.course_type }}</td>
                    <td>{{ r.note }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

    </div>

    {% elif name and birthday %}
    <div class="card mt-3">
        <p class="text-center" style="color: var(--gold);">查無紀錄。</p>
    </div>
    {% endif %}

</div>

</body>
</html>
